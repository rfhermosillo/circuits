\documentclass[a4paper,twoside,10pt]{report}

% \usepackage[T1]{fontenc}
\usepackage{xcolor}
\usepackage[bookmarks=false,colorlinks=true,linkcolor={black},urlcolor={red},citecolor={purple}]{hyperref}

\usepackage{acro}
% \usepackage{lmodern}
\usepackage{graphicx}
\usepackage{parskip}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{derivative}
\usepackage[margin=1in]{geometry}
\usepackage{mathtools} % \DeclarePairedDelimiter
\usepackage{siunitx}
\usepackage[american,siunitx]{circuitikz}
\usepackage{xspace}

\input{acronyms.tex}

\usepackage[
    backend=biber,
    backref=true,
    style=authortitle-ibid,
    %style=authoryear,
    autocite=inline,
    %refsection=subsection,
    ]{biblatex}
\addbibresource{references.bib}

% Starred variant uses \left/\right.
% Optional argument can specify a size command like \big or \Big
\DeclarePairedDelimiter\abs{\lvert}{\rvert}

% \NewDocumentCommand\abs{m}{\ensuremath{\left|#1\right|}\xspace}
\NewDocumentCommand\sub{m}{\ensuremath{_\mathrm{#1}}\xspace}

\NewDocumentCommand\gnd{}{GND\xspace}
\NewDocumentCommand\R{o}{\ensuremath{R\IfValueT{#1}{\sub{#1}}}\xspace}
\NewDocumentCommand\Z{o}{\ensuremath{Z\IfValueT{#1}{\sub{#1}}}\xspace}
\NewDocumentCommand\C{o}{\ensuremath{C\IfValueT{#1}{\sub{#1}}}\xspace}
\NewDocumentCommand\f{o}{\ensuremath{f\IfValueT{#1}{\sub{#1}}}\xspace}
\NewDocumentCommand\w{o}{\ensuremath{\omega\IfValueT{#1}{\sub{#1}}}\xspace}

% TODO: what subscript to use for input? 'i' or 's'? GHLM uses 'i' except where the source resistance Rs is important (to distinguish it from the circuit input resistance Ri).
\NewDocumentCommand\vin{o}{\ensuremath{v_{i\IfValueT{#1}{#1}}}\xspace}
\NewDocumentCommand\iin{o}{\ensuremath{i_{i\IfValueT{#1}{#1}}}\xspace}
\NewDocumentCommand\rin{}{\ensuremath{R_i}\xspace}
\NewDocumentCommand\vout{o}{\ensuremath{v_{o}\IfValueT{#1}{#1}}\xspace}
\NewDocumentCommand\VOUT{o}{\ensuremath{V_{O}\IfValueT{#1}{#1}}\xspace}
\NewDocumentCommand\rout{o}{\ensuremath{r_{o\IfValueT{#1}{#1}}}\xspace}
\NewDocumentCommand\rpi{o}{\ensuremath{r_{\pi\IfValueT{#1}{#1}}}\xspace}
% TODO: add Vth, Vbe, \npn, \pnp, RL, \VT and \VTH (MOSFET threshold voltage), \BF (and what other betas?), \VGS, \VDS, \VCC, \VEE, \VDD, \VSS, \Vov for MOSFET overdrive

\NewDocumentCommand\s{}{\ensuremath{s}\xspace}
\NewDocumentCommand\jomega{o}{\ensuremath{\jmath\omega_{\IfValueT{#1}{#1}}}\xspace}
\NewDocumentCommand\Hs{}{\ensuremath{H(s)}\xspace}
\NewDocumentCommand\Hpass{}{\ensuremath{H_0}\xspace}
\NewDocumentCommand\fcutoff{}{\ensuremath{f\sub{c}}\xspace}
\NewDocumentCommand\wcutoff{}{\ensuremath{\omega\sub{c}}\xspace}
\NewDocumentCommand\Q{}{\ensuremath{Q}\xspace}

% Use uppercase for the command names since \ac is already defined
\NewDocumentCommand\AC{}{\ac{ac}\xspace}
\NewDocumentCommand\DC{}{\ac{dc}\xspace}

% #1: Name of the op amp, for naming coordinates (default: "OA"). Coordinates are #1-in- and #1-in+ for the input nodes (to the left of the op amp's - and + anchors), #1-in-above for the coordinate above #1-in and left of the feedback element, and #1-fb-left for the coordinate at the left of the feedback element.
% #2: Start coordinate without parentheses (e.g. "0,0"). 
% #3: Inverting input network, starting at coordinate #1-in-
% #4: Feedback element (e.g. "R=$R_F$")
% #5: Non-inverting input network, starting at coordinate #1-in+
% #6: Output node name. If provided, a wire is drawn from the op amp output to an ocirc node with the given name. No wire or node is drawn if not provided.
\NewDocumentCommand\invertingopamp{O{OA} m m m m o}{
    \draw (\IfNoValueTF{#2}{0,0}{#2}) coordinate(#1-in-) to[short,*-] ++(0.5,0) node[op amp, anchor=-](#1){}
	(#1.+) to[short] ++(-0.5,0) (#1.+ -| #1-in-) coordinate(#1-in+)
    (#1-in-) #3
    (#1-in-) to[short] ++(0,1.25) coordinate(#1-in-above) |- ++(0.5,0) coordinate(#1-fb-left) to[#4] ++(2,0) -| (#1.out)
    (#1-in+) #5
    \IfValueT{#6}{(#1.out) to[short, -o] ++(1,0) node[above]{#6}}
    ;
    \node[circ] at (#1.out){};
}

\begin{document}

\pagestyle{empty} % no headings for the first pages

\title{A Library of Circuits}
\author{Richard Hermosillo}
%\date{} % the current date is used if commented out
\maketitle

\acuseall % mark all acronyms as "used" so the short form will be used in the ToC
\tableofcontents
\acresetall
\cleardoublepage % the first chapter should start on an odd page.
\pagestyle{plain} % display headings: headings / fancy / ...

%\chapter*{Introduction}
% TODO add introduction
\include{opampcircuits}
\include{inamps}
\include{filters}
\include{compensators}
%\include{diodes}
%\include{advancedopampcircuits}
\include{transistoramplifiers}
\include{voltagereferences}
\include{currentmirrors}
\include{outputamplifiers}
%\include{comparators}
%\include{translinear}
\include{converters}
\include{chargepumps}
%\include{opampdesigns}
%\include{oscillators}

%\chapter{Snubbers}

%\section{RC Snubber}

%\section{Diode Snubber}

\printbibliography[heading=bibintoc,title=References]

\end{document}

